# Займы онлайн - Мобильное приложение

Мобильное приложение для просмотра и сравнения предложений от микрофинансовых организаций с функцией push-уведомлений.

## Содержание

1. [Описание проекта](#описание-проекта)
2. [Запуск проекта](#запуск-проекта)
3. [Сборка мобильного приложения](#сборка-мобильного-приложения)
4. [Работа с push-уведомлениями](#работа-с-push-уведомлениями)
5. [Административная панель](#административная-панель)
6. [Структура проекта](#структура-проекта)

## Описание проекта

Данное приложение представляет собой агрегатор займов от МФО. Пользователи могут:

- Просматривать список доступных займов
- Фильтровать займы по сумме и сроку
- Рассчитывать условия займа с помощью калькулятора
- Переходить на сайты МФО для оформления займа
- Получать push-уведомления о новых предложениях

Приложение доступно как в веб-версии, так и в виде мобильного приложения для Android.

## Запуск проекта

### Быстрый запуск

Вы можете запустить проект, используя готовый скрипт:

```bash
./build-and-run-app.sh
```

### Ручной запуск

Для запуска веб-версии:

```bash
npm run dev
```

Для запуска сервера push-уведомлений:

```bash
node run-push-server.js
```

## Сборка мобильного приложения

### Подготовка к сборке APK

1. Установите необходимые инструменты:
   ```bash
   npm install -g @capacitor/cli
   ```

2. Подготовьте проект к сборке:
   ```bash
   node prepare-for-apk.js
   ```

3. Запустите скрипт сборки:
   ```bash
   ./build-apk.sh
   ```

### Ручная сборка

1. Создайте сборку для веб:
   ```bash
   npm run build
   ```

2. Синхронизируйте файлы с Capacitor:
   ```bash
   npx cap sync android
   ```

3. Откройте проект в Android Studio:
   ```bash
   npx cap open android
   ```

4. Соберите APK в Android Studio:
   - Build -> Build Bundle(s) / APK(s) -> Build APK(s)

### Firebase Cloud Messaging

Для работы push-уведомлений в мобильной версии необходимо настроить Firebase:

1. Создайте проект в [Firebase Console](https://console.firebase.google.com)
2. Добавьте приложение Android с ID пакета `ru.yourcompany.microloans`
3. Скачайте файл `google-services.json`
4. Замените файл `capacitor-app/google-services.json`

## Работа с push-уведомлениями

### Настройка OneSignal

В проекте используется OneSignal для отправки push-уведомлений. Убедитесь, что в переменных окружения установлены:

- `VITE_ONESIGNAL_APP_ID`
- `VITE_ONESIGNAL_REST_API_KEY`

Подробную информацию о настройке push-уведомлений можно найти в [руководстве по push-уведомлениям](PUSH_NOTIFICATION_GUIDE.md).

### Отправка уведомлений

Отправить уведомление можно через административную панель:

1. Войдите в админ-панель (логин: admin, пароль: admin123)
2. Перейдите в раздел "Push-уведомления"
3. Заполните форму и отправьте уведомление

## Административная панель

Административная панель доступна по адресу `/admin`. 

Учетные данные по умолчанию:
- Логин: `admin`
- Пароль: `admin123`

В панели администратора вы можете:
- Управлять списком займов (добавлять, редактировать, удалять)
- Отправлять push-уведомления
- Просматривать статистику

## Структура проекта

```
/
├── android/                      # Файлы Android-приложения (генерируются)
├── capacitor-app/                # Папка для подготовки Capacitor 
├── client/                       # Клиентская часть (React)
│   ├── src/                      # Исходный код
│   │   ├── assets/               # Статические ресурсы
│   │   ├── components/           # React-компоненты
│   │   ├── hooks/                # React hooks
│   │   ├── lib/                  # Утилиты и библиотеки
│   │   ├── pages/                # Страницы приложения
│   │   └── App.tsx               # Основной компонент
│   ├── app-config.json           # Конфигурация приложения
│   └── google-services.json.template # Шаблон Firebase конфигурации
├── public/                       # Статические файлы
├── server/                       # Серверная часть
│   ├── routes.ts                 # API маршруты
│   ├── storage.ts                # Работа с данными
│   └── index.ts                  # Точка входа сервера
├── shared/                       # Общие модули
│   └── schema.ts                 # Схема данных
├── build-apk.sh                  # Скрипт сборки APK
├── build-and-run-app.sh          # Скрипт запуска проекта
├── capacitor.config.ts           # Конфигурация Capacitor
├── PUSH_NOTIFICATION_GUIDE.md    # Руководство по push-уведомлениям
└── README.md                     # Этот файл
```

## Дополнительная документация

- [Руководство по push-уведомлениям](PUSH_NOTIFICATION_GUIDE.md)
- [Настройка мобильного приложения](client/PUSH_NOTIFICATION_SETUP.md)
- [Решение проблем](TROUBLESHOOTING.md)