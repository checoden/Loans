 cd capacitor-app
  cd capacitor-app
  echo "üöÄ === –ù–ê–ß–ê–õ–û –°–û–ó–î–ê–ù–ò–Ø ANDROID –ü–†–û–ï–ö–¢–ê ==="
  
  echo "üìÅ –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —à–∞–±–ª–æ–Ω–∞ –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞:"
  ls -la ../AndroidManifest-template.xml && echo "‚úÖ –®–∞–±–ª–æ–Ω –Ω–∞–π–¥–µ–Ω" || echo "‚ùå –®–∞–±–ª–æ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω"
  
  echo "üîß –°–æ–∑–¥–∞–µ–º Android –ø–ª–∞—Ç—Ñ–æ—Ä–º—É..."
  npx cap add android || {
    echo "‚ö†Ô∏è –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ Android –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã..."
    rm -rf android node_modules;
    npm install;
    npm install @capacitor/core@7.2.0 @capacitor/android@7.2.0 onesignal-cordova-plugin@5.2.13;
    npx cap add android;
  }
  
  echo "üìÑ –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–∑–æ–≤—ã–π –º–∞–Ω–∏—Ñ–µ—Å—Ç –ø–æ—Å–ª–µ cap add:"
  cat android/app/src/main/AndroidManifest.xml
  echo "üìã –†–∞–∑—Ä–µ—à–µ–Ω–∏—è –≤ –±–∞–∑–æ–≤–æ–º –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ:"
  grep "uses-permission" android/app/src/main/AndroidManifest.xml || echo "–ù–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –≤ –±–∞–∑–æ–≤–æ–º –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ"
  
  echo "üì¶ –ö–æ–ø–∏—Ä—É–µ–º google-services.json..."
  cp ../google-services.json android/app/google-services.json || true
  
  echo "üîÑ –í—ã–ø–æ–ª–Ω—è–µ–º cap sync android..."
  npx cap sync android
  
  echo "üìÑ –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–∞–Ω–∏—Ñ–µ—Å—Ç –ø–æ—Å–ª–µ cap sync:"
  cat android/app/src/main/AndroidManifest.xml
  echo "üìã –†–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø–æ—Å–ª–µ cap sync:"
  grep "uses-permission" android/app/src/main/AndroidManifest.xml || echo "–ù–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –ø–æ—Å–ª–µ cap sync"
  
  echo "üìù –ö–æ–ø–∏—Ä—É–µ–º –Ω–∞—à —à–∞–±–ª–æ–Ω –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞..."
  cp ../AndroidManifest-template.xml android/app/src/main/AndroidManifest.xml || {
    echo "‚ùå –û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —à–∞–±–ª–æ–Ω–∞!"
    ls -la ../AndroidManifest-template.xml
    exit 1
  }
  
  echo "‚úÖ === –§–ò–ù–ê–õ–¨–ù–´–ô –ú–ê–ù–ò–§–ï–°–¢ –ü–û–°–õ–ï –ö–û–ü–ò–†–û–í–ê–ù–ò–Ø –®–ê–ë–õ–û–ù–ê ==="
  cat android/app/src/main/AndroidManifest.xml
  echo "üîç === –°–ü–ò–°–û–ö –í–°–ï–• –†–ê–ó–†–ï–®–ï–ù–ò–ô ==="
  grep "uses-permission" android/app/src/main/AndroidManifest.xml || echo "‚ùå –†–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ —Ñ–∏–Ω–∞–ª—å–Ω–æ–º –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ!"
  
  chmod +x ./create-directories.sh
  ./create-directories.sh
  cd ..
  
  echo "üîß –ó–∞–ø—É—Å–∫–∞–µ–º setup-android-notification-channel.js..."
  node setup-android-notification-channel.js
  
  echo "üìÑ –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–∞–Ω–∏—Ñ–µ—Å—Ç –ø–æ—Å–ª–µ notification script:"
  cat capacitor-app/android/app/src/main/AndroidManifest.xml
  echo "üìã –†–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø–æ—Å–ª–µ notification script:"
  grep "uses-permission" capacitor-app/android/app/src/main/AndroidManifest.xml || echo "–ù–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –ø–æ—Å–ª–µ notification script"
  
  cd capacitor-app
  node update-gradle-signing.js
  node update-android-plugin.js
  shell: /usr/bin/bash -e {0}
  env:
    JAVA_HOME: /opt/hostedtoolcache/Java_Temurin-Hotspot_jdk/21.0.7-6/x64
    JAVA_HOME_21_X64: /opt/hostedtoolcache/Java_Temurin-Hotspot_jdk/21.0.7-6/x64
    VITE_ONESIGNAL_APP_ID: ***
    VITE_ONESIGNAL_REST_API_KEY: ***
üöÄ === –ù–ê–ß–ê–õ–û –°–û–ó–î–ê–ù–ò–Ø ANDROID –ü–†–û–ï–ö–¢–ê ===
üìÅ –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —à–∞–±–ª–æ–Ω–∞ –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞:
-rw-r--r-- 1 runner docker 2028 May 28 15:21 ../AndroidManifest-template.xml
‚úÖ –®–∞–±–ª–æ–Ω –Ω–∞–π–¥–µ–Ω
üîß –°–æ–∑–¥–∞–µ–º Android –ø–ª–∞—Ç—Ñ–æ—Ä–º—É...
Error:  android platform already exists.
        To re-add this platform, first remove ./android, then run this command again.
        WARNING: Your native project will be completely removed.
‚ö†Ô∏è –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ Android –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã...

added 112 packages, and audited 113 packages in 935ms

19 packages are looking for funding
  run `npm fund` for details

found 0 vulnerabilities

up to date, audited 113 packages in 550ms

19 packages are looking for funding
  run `npm fund` for details

found 0 vulnerabilities
‚úî Adding native android project in android in 35.71ms
‚úî add in 36.41ms
‚úî Copying web assets from www to android/app/src/main/assets/public in 4.09ms
‚úî Creating capacitor.config.json in android/app/src/main/assets in 403.25Œºs
[info] Found 1 Cordova plugin for android:
       onesignal-cordova-plugin@5.2.13
‚úî copy android in 34.47ms
‚úî Updating Android plugins in 2.67ms
[info] Found 1 Cordova plugin for android:
       onesignal-cordova-plugin@5.2.13
‚úî update android in 35.14ms
‚úî Syncing Gradle in 173.88Œºs
[success] android platform added!
Follow the Developer Workflow guide to get building:
https://capacitorjs.com/docs/basics/workflow
üìÑ –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–∑–æ–≤—ã–π –º–∞–Ω–∏—Ñ–µ—Å—Ç –ø–æ—Å–ª–µ cap add:
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android">

    <application
        android:allowBackup="true"
        android:icon="@mipmap/ic_launcher"
        android:label="@string/app_name"
        android:roundIcon="@mipmap/ic_launcher_round"
        android:supportsRtl="true"
        android:theme="@style/AppTheme">

        <activity
            android:configChanges="orientation|keyboardHidden|keyboard|screenSize|locale|smallestScreenSize|screenLayout|uiMode|navigation"
            android:name=".MainActivity"
            android:label="@string/title_activity_main"
            android:theme="@style/AppTheme.NoActionBarLaunch"
            android:launchMode="singleTask"
            android:exported="true">

            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>

        </activity>

        <provider
            android:name="androidx.core.content.FileProvider"
            android:authorities="${applicationId}.fileprovider"
            android:exported="false"
            android:grantUriPermissions="true">
            <meta-data
                android:name="android.support.FILE_PROVIDER_PATHS"
                android:resource="@xml/file_paths"></meta-data>
        </provider>
    </application>

    <!-- Permissions -->

    <uses-permission android:name="android.permission.INTERNET" />
</manifest>
üìã –†–∞–∑—Ä–µ—à–µ–Ω–∏—è –≤ –±–∞–∑–æ–≤–æ–º –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ:
    <uses-permission android:name="android.permission.INTERNET" />
üì¶ –ö–æ–ø–∏—Ä—É–µ–º google-services.json...
üîÑ –í—ã–ø–æ–ª–Ω—è–µ–º cap sync android...
‚úî Copying web assets from www to android/app/src/main/assets/public in 8.96ms
‚úî Creating capacitor.config.json in android/app/src/main/assets in 1.00ms
[info] Found 1 Cordova plugin for android:
       onesignal-cordova-plugin@5.2.13
‚úî copy android in 42.95ms
‚úî Updating Android plugins in 2.67ms
[info] Found 1 Cordova plugin for android:
       onesignal-cordova-plugin@5.2.13
‚úî update android in 43.89ms
[info] Sync finished in 0.101s
üìÑ –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–∞–Ω–∏—Ñ–µ—Å—Ç –ø–æ—Å–ª–µ cap sync:
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android">

    <application
        android:allowBackup="true"
        android:icon="@mipmap/ic_launcher"
        android:label="@string/app_name"
        android:roundIcon="@mipmap/ic_launcher_round"
        android:supportsRtl="true"
        android:theme="@style/AppTheme">

        <activity
            android:configChanges="orientation|keyboardHidden|keyboard|screenSize|locale|smallestScreenSize|screenLayout|uiMode|navigation"
            android:name=".MainActivity"
            android:label="@string/title_activity_main"
            android:theme="@style/AppTheme.NoActionBarLaunch"
            android:launchMode="singleTask"
            android:exported="true">

            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>

        </activity>

        <provider
            android:name="androidx.core.content.FileProvider"
            android:authorities="${applicationId}.fileprovider"
            android:exported="false"
            android:grantUriPermissions="true">
            <meta-data
                android:name="android.support.FILE_PROVIDER_PATHS"
                android:resource="@xml/file_paths"></meta-data>
        </provider>
    </application>

    <!-- Permissions -->

    <uses-permission android:name="android.permission.INTERNET" />
</manifest>
üìã –†–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø–æ—Å–ª–µ cap sync:
    <uses-permission android:name="android.permission.INTERNET" />
üìù –ö–æ–ø–∏—Ä—É–µ–º –Ω–∞—à —à–∞–±–ª–æ–Ω –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞...
‚úÖ === –§–ò–ù–ê–õ–¨–ù–´–ô –ú–ê–ù–ò–§–ï–°–¢ –ü–û–°–õ–ï –ö–û–ü–ò–†–û–í–ê–ù–ò–Ø –®–ê–ë–õ–û–ù–ê ===
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android">

    <application
        android:allowBackup="true"
        android:icon="@mipmap/ic_launcher"
        android:label="@string/app_name"
        android:roundIcon="@mipmap/ic_launcher_round"
        android:supportsRtl="true"
        android:theme="@style/AppTheme">

        <activity
            android:configChanges="orientation|keyboardHidden|keyboard|screenSize|locale|smallestScreenSize|screenLayout|uiMode|navigation"
            android:name=".MainActivity"
            android:label="@string/title_activity_main"
            android:theme="@style/AppTheme.NoActionBarLaunch"
            android:launchMode="singleTask"
            android:exported="true">

            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>

        </activity>

        <provider
            android:name="androidx.core.content.FileProvider"
            android:authorities="${applicationId}.fileprovider"
            android:exported="false"
            android:grantUriPermissions="true">
            <meta-data
                android:name="android.support.FILE_PROVIDER_PATHS"
                android:resource="@xml/file_paths"></meta-data>
        </provider>
    </application>

    <!-- Permissions -->
    <uses-permission android:name="android.permission.INTERNET" />
    
    <!-- Push notification permissions -->
    <uses-permission android:name="android.permission.POST_NOTIFICATIONS" />
    <uses-permission android:name="android.permission.WAKE_LOCK" />
    <uses-permission android:name="android.permission.VIBRATE" />
    <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />
    <uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
</manifest>üîç === –°–ü–ò–°–û–ö –í–°–ï–• –†–ê–ó–†–ï–®–ï–ù–ò–ô ===
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.POST_NOTIFICATIONS" />
    <uses-permission android:name="android.permission.WAKE_LOCK" />
    <uses-permission android:name="android.permission.VIBRATE" />
    <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />
    <uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
‚úÖ network_security_config.xml —Å–æ–∑–¥–∞–Ω
‚úÖ ic_stat_onesignal_default.xml —Å–æ–∑–¥–∞–Ω
‚úÖ –í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏ —Ñ–∞–π–ª—ã –¥–ª—è Android —Å–æ–∑–¥–∞–Ω—ã
üîß –ó–∞–ø—É—Å–∫–∞–µ–º setup-android-notification-channel.js...
üîç –ü—Ä–æ–≤–µ—Ä—è—é –∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É—é –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–∞–∫–µ—Ç–∞...
‚úÖ applicationId –≤ build.gradle —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ: ru.checoden.online***
‚úÖ Push-—Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —É–∂–µ –µ—Å—Ç—å –≤ AndroidManifest.xml
‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ package –≤ AndroidManifest.xml

üîî –ù–∞—á–∏–Ω–∞—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É –∫–∞–Ω–∞–ª–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–ª—è Android...
üìù –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É—é —Ñ–∞–π–ª MainActivity.java...
‚úÖ –ö–æ–¥ –¥–ª—è –∫–∞–Ω–∞–ª–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω –≤ MainActivity.java

‚úÖ –ö–∞–Ω–∞–ª —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —É—Å–ø–µ—à–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω!

üì± –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å–±–æ—Ä–∫—É APK:
1. –û—Ç–∫—Ä–æ–π—Ç–µ Android Studio: npx cap open android
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–±–æ—Ä–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (Build > Build Bundle(s) / APK(s) > Build APK(s))

üîî –í–∞–∂–Ω–æ! –î–ª—è —Ä–∞–±–æ—Ç—ã push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ google-services.json –≤ –ø–∞–ø–∫–µ capacitor-app —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π package_name: ru.checoden.online***
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω –¥–ª—è –≠–¢–û–ì–û –ø—Ä–æ–µ–∫—Ç–∞ –≤ Firebase Console –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ API-–∫–ª—é—á–∏
üìÑ –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–∞–Ω–∏—Ñ–µ—Å—Ç –ø–æ—Å–ª–µ notification script:
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android">

    <application
        android:allowBackup="true"
        android:icon="@mipmap/ic_launcher"
        android:label="@string/app_name"
        android:roundIcon="@mipmap/ic_launcher_round"
        android:supportsRtl="true"
        android:theme="@style/AppTheme">

        <activity
            android:configChanges="orientation|keyboardHidden|keyboard|screenSize|locale|smallestScreenSize|screenLayout|uiMode|navigation"
            android:name=".MainActivity"
            android:label="@string/title_activity_main"
            android:theme="@style/AppTheme.NoActionBarLaunch"
            android:launchMode="singleTask"
            android:exported="true">

            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>

        </activity>

        <provider
            android:name="androidx.core.content.FileProvider"
            android:authorities="${applicationId}.fileprovider"
            android:exported="false"
            android:grantUriPermissions="true">
            <meta-data
                android:name="android.support.FILE_PROVIDER_PATHS"
                android:resource="@xml/file_paths"></meta-data>
        </provider>
    </application>

    <!-- Permissions -->
    <uses-permission android:name="android.permission.INTERNET" />
    
    <!-- Push notification permissions -->
    <uses-permission android:name="android.permission.POST_NOTIFICATIONS" />
    <uses-permission android:name="android.permission.WAKE_LOCK" />
    <uses-permission android:name="android.permission.VIBRATE" />
    <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />
    <uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
</manifest>üìã –†–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø–æ—Å–ª–µ notification script:
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.POST_NOTIFICATIONS" />
    <uses-permission android:name="android.permission.WAKE_LOCK" />
    <uses-permission android:name="android.permission.VIBRATE" />
    <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />
    <uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
–û–±–Ω–æ–≤–ª—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–ø–∏—Å–∏ –≤ build.gradle...
‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–ø–∏—Å–∏ —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω—ã –≤ build.gradle
–û–±–Ω–æ–≤–ª—è–µ–º –≤–µ—Ä—Å–∏—é Android Gradle Plugin –¥–æ 8.9...
‚úÖ –í–µ—Ä—Å–∏—è Android Gradle Plugin –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ 8.9
‚úÖ –§–∞–π–ª gradle.properties –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ AGP 8.9
‚úÖ –§–∞–π–ª app/build.gradle –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ AGP 8.9